---
title: MongoDB/Elasticsearch 瞎对比
date: 2017-08-18 17:40:07
tags:
---

# MongoDB

## 特点
<!-- more -->
- 面向集合存储，易存储对象类型的数据
- 模式自由
- 支持动态查询
- 支持完全索引，包含内部对象
- 支持查询
- 支持复制和故障恢复
- 使用高效的二进制数据存储，包括大型对象（如视频等）
- 自动处理碎片，以支持云计算层次的扩展性
- 支持RUBY，PYTHON，JAVA，C++，PHP，C#等多种语言
- 文件存储格式为BSON（一种JSON的扩展）
- 可通过网络访问

## 内存原理

mongodb使用_内存映射_存储引擎:

>  它会把数据文件映射到内存中，如果是读操作，内存中的数据起到缓存的作用，如果是写操作，内存还可以把随机的写操作转换成顺序的写操作，总之可以大幅度提升性能。MongoDB并不干涉内存管理工作，而是把这些工作留给操作系统的虚拟内存管理器去处理，这样做的好处是简化了MongoDB的工作，但坏处是你没有方法很方便的控制MongoDB占多大内存，幸运的是虚拟内存管理器的存在让我们多数时候并不需要关心这个问题

## 使用场景

-  网站数据：Mongo 非常适合实时的插入，更新与查询，并具备网站实时数据存储所需的复制及高度伸缩性
-  缓存：由于性能很高，Mongo 也适合作为信息基础设施的缓存层。在系统重启之后，由Mongo 搭建的持久化缓存层可以避免下层的数据源过载
-  大尺寸、低价值的数据：使用传统的关系型数据库存储一些数据时可能会比较昂贵，在此之前，很多时候程序员往往会选择传统的文件进行存储
-  高伸缩性的场景：Mongo 非常适合由数十或数百台服务器组成的数据库，Mongo 的路线图中已经包含对MapReduce 引擎的内置支持
-  用于对象及JSON 数据的存储：Mongo 的BSON 数据格式非常适合文档化格式的存储及查询

**限制**

1.  高度事务性的系统：例如，银行或会计系统。传统的关系型数据库目前还是更适用于需要大量原子性复杂事务的应用程序。
2.  传统的商业智能应用：针对特定问题的BI 数据库会产生高度优化的查询方式。对于此类应用，数据仓库可能是更合适的选择。
3.  复杂的跨文档（表）级联查询。

## 上手难度

部署难度： ★☆

集群难度： ★★

API使用难度： ★★

学习成本：★☆


# Elasticsearch

## 特点

- 分布式
- 全文搜索，结构化检索，数据分析
- 零配置
- 自动发现
- 索引自动分片
- 索引副本机制
- restful风格接口
- 多数据源
- 自动搜索负载
- 对海量数据进行实时处理

## 索引原理

**倒排索引(inverted index)**，也常被称为反向索引、置入档案或反向档案，是一种索引方法，被用来存储在全文搜索下某个单词在一个文档或者一组文档中的存储位置的映射。它是文档检索系统中最常用的数据结构。通过倒排索引，可以根据单词快速获取包含这个单词的文档列表。倒排索引主要由两个部分组成：“单词词典”和“倒排文件”。

倒排索引有两种不同的反向索引形式：

1. 一条记录的水平反向索引（或者反向档案索引）包含每个引用单词的文档的列表
2. 一个单词的水平反向索引（或者完全反向索引）又包含每个单词在一个文档中的位置

后者的形式提供了更多的兼容性（比如短语搜索），但是需要更多的时间和空间来创建。

## 使用场景

- 站内搜索（电商，招聘，门户，等等），IT系统搜索（OA，CRM，ERP，等等），数据分析
- BI系统，商业智能，Business Intelligence。
- 可以搜索日志或者交易数据，用来分析商业趋势、搜集日志、分析系统瓶颈或者运行发展等等
- 分析商业信息，在百万级的大数据中轻松的定位关键信息
- 提供了强大的搜索功能，可以实现类似百度、谷歌等搜索

**限制**

1.  不支持包含频繁更新、事务（transaction）的操作
2.  分片的数量只能在创建索引的时候指定，不能在后期修改

## 上手难度

部署难度： ★

集群难度： ★☆

API使用难度： ★★

学习成本：★★☆
